# 네트워크 기능 최우선 구현 계획

## 🎯 목표
**"SNS처럼 네트워크를 생성"** 피드백에 따라, 사용자 간 연결과 협업이 가능한 네트워크 기능을 최우선으로 구현합니다.

---

## 📋 최우선 구현 기능 (Priority 0)

### 1. 일정 공유 기능 ⭐⭐⭐
**목표**: 사용자가 자신의 일정을 다른 사용자와 공유할 수 있게 함

#### 1.1 친구/연락처 시스템
- [ ] 친구 추가 기능
  - 사용자 검색 (이메일, 사용자명)
  - 친구 요청 보내기/받기
  - 친구 수락/거절
- [ ] 친구 목록 관리
  - `friends/{userId}/friends/{friendId}` Firestore 구조
  - 친구 상태: `pending`, `accepted`, `blocked`
- [ ] 친구 프로필 보기
  - 기본 정보 (이름, 프로필 사진)
  - 공유된 일정 목록

#### 1.2 일정 공유 권한 설정
- [ ] 공유 설정 UI
  - 일정별 공유 설정 (공유 안 함 / 특정 친구 / 모든 친구)
  - 권한 설정 (읽기 전용 / 수정 가능)
- [ ] Firestore 구조
  ```
  sharedSchedules/{scheduleId}
    - ownerId: string
    - sharedWith: [{ userId, permission: 'read' | 'write' }]
    - scheduleData: {...}
  ```

#### 1.3 공유 일정 실시간 동기화
- [ ] Firestore 실시간 리스너
  - 공유 일정 변경 시 모든 공유자에게 실시간 업데이트
  - `onSnapshot`으로 변경사항 감지
- [ ] UI 업데이트
  - 공유 일정 변경 시 알림 표시
  - 캘린더에 공유 일정 표시 (다른 색상)

#### 1.4 공유 링크 생성
- [ ] 공유 링크 생성 기능
  - 일정별 고유 링크 생성 (`/shared/{scheduleId}`)
  - 링크 복사 버튼
- [ ] 공유 링크 접근
  - 비로그인 사용자도 링크로 일정 보기 가능 (읽기 전용)
  - 로그인 사용자는 링크로 일정 공유 요청 가능

---

### 2. 일정 알림 메시지 시스템 ⭐⭐⭐
**목표**: 사용자 간 일정 관련 소통 강화

#### 2.1 일정 시작 전 알림
- [ ] 알림 설정 UI
  - 일정별 알림 시간 설정 (15분 전, 1시간 전, 하루 전 등)
  - 기본 알림 설정
- [ ] FCM 알림 전송
  - Cloud Functions에서 일정 시작 시간 계산
  - 설정된 시간에 FCM 푸시 전송
- [ ] 알림 메시지
  - "15분 후 '회의' 일정이 시작됩니다"
  - "1시간 후 '오픽 시험 준비' 일정이 시작됩니다"

#### 2.2 공유 일정 변경 알림
- [ ] 변경 감지
  - Firestore 트리거로 공유 일정 변경 감지
  - 변경 타입: 추가, 수정, 삭제
- [ ] 알림 전송
  - 공유된 모든 사용자에게 알림
  - "친구가 '회의' 일정을 수정했습니다"
  - "친구가 새로운 일정을 추가했습니다"

#### 2.3 일정 참석 확인 요청
- [ ] 참석 확인 UI
  - 일정에 "참석 확인 요청" 버튼
  - 참석/불참/미정 선택
- [ ] 참석 상태 표시
  - 일정 상세에 참석자 목록 표시
  - 참석 상태별 색상 구분
- [ ] 알림
  - 참석 확인 요청 시 알림 전송
  - 참석 상태 변경 시 알림

---

### 3. 외부 SNS 연동 ⭐⭐
**목표**: 일정을 외부 플랫폼에 공유하여 네트워크 확장

#### 3.1 웹 공유 API 활용
- [ ] 공유 버튼 UI
  - 일정 상세에 "공유하기" 버튼
  - 네이티브 공유 다이얼로그 열기
- [ ] 공유 데이터
  - 일정 제목, 날짜, 시간
  - 공유 링크 포함
  - 간단한 설명

#### 3.2 공유 링크 생성 및 프리뷰
- [ ] 링크 프리뷰 (Open Graph)
  - 일정 제목, 날짜, 시간
  - 일정 설명
  - 썸네일 이미지 (선택)
- [ ] 공유 링크 접근
  - 비로그인 사용자도 일정 보기 가능
  - 로그인 유도 (일정 수정/참석 확인 시)

---

## 📅 구현 단계 (이번주 일요일 마감)

### 🚨 최우선: 핵심 기능만 구현 (오늘 ~ 일요일)

#### Day 1 (오늘): 친구 시스템 + 기본 공유
- [ ] 친구 검색 및 추가 기능
- [ ] 친구 목록 표시
- [ ] 일정 공유 설정 UI (기본)
- [ ] 공유 일정 보기 (읽기 전용)

#### Day 2 (내일): 공유 링크 + 실시간 동기화
- [ ] 공유 링크 생성 기능
- [ ] 공유 링크로 일정 보기
- [ ] Firestore 실시간 리스너 (공유 일정 변경 감지)
- [ ] UI 실시간 업데이트

#### Day 3 (모레): 알림 시스템 (핵심만)
- [ ] 공유 일정 변경 알림 (FCM)
- [ ] 알림 센터 UI (기본)
- [ ] 일정 시작 전 알림 (기본 설정만, 15분 전)

#### Day 4 (금요일): 외부 연동 (최소 기능)
- [ ] 웹 공유 API (네이티브 공유 다이얼로그)
- [ ] 공유 링크 프리뷰 (기본)

#### Day 5-6 (토요일-일요일): 통합 테스트 + 버그 수정
- [ ] 전체 기능 통합 테스트
- [ ] 버그 수정
- [ ] 데모 준비

---

### 📋 상세 일정

#### Phase 1: 기본 공유 기능 (Day 1-2)
1. 친구 시스템 기본 구조
2. 일정 공유 설정 UI
3. 공유 일정 보기
4. 공유 링크 생성
5. 실시간 동기화 (기본)

#### Phase 2: 알림 시스템 (Day 3)
1. 공유 일정 변경 알림
2. 일정 시작 전 알림 (기본)
3. 알림 센터 UI

#### Phase 3: 외부 연동 (Day 4)
1. 웹 공유 API
2. 링크 프리뷰 (기본)

#### Phase 4: 통합 및 테스트 (Day 5-6)
1. 전체 기능 통합
2. 버그 수정
3. 데모 준비

---

## 🛠 기술 스택

### Firestore 구조
```
users/{userId}
  - friends: { friendId: { status, createdAt } }
  - sharedSchedules: { scheduleId: { permission } }

sharedSchedules/{scheduleId}
  - ownerId: string
  - sharedWith: [{ userId, permission }]
  - scheduleData: {...}
  - createdAt: timestamp
  - updatedAt: timestamp

notifications/{userId}/notifications/{notificationId}
  - type: 'schedule_reminder' | 'schedule_shared' | 'attendance_request'
  - scheduleId: string
  - message: string
  - read: boolean
  - createdAt: timestamp
```

### Cloud Functions
- `onScheduleShared`: 공유 일정 생성 시 알림
- `onScheduleUpdated`: 공유 일정 변경 시 알림
- `sendScheduleReminder`: 일정 시작 전 알림 전송 (스케줄러)

### 클라이언트 컴포넌트
- `FriendList.jsx`: 친구 목록
- `ShareScheduleModal.jsx`: 일정 공유 설정
- `SharedScheduleView.jsx`: 공유 일정 보기
- `NotificationCenter.jsx`: 알림 센터

---

## ✅ 체크리스트

### 친구 시스템
- [ ] 사용자 검색 기능
- [ ] 친구 요청 보내기/받기
- [ ] 친구 목록 표시
- [ ] 친구 프로필 보기

### 일정 공유
- [ ] 일정 공유 설정 UI
- [ ] 공유 권한 설정 (읽기/쓰기)
- [ ] 공유 일정 목록
- [ ] 공유 일정 보기
- [ ] 공유 링크 생성

### 실시간 동기화
- [ ] Firestore 실시간 리스너
- [ ] 공유 일정 변경 감지
- [ ] UI 실시간 업데이트

### 알림 시스템
- [ ] 일정 시작 전 알림 설정
- [ ] FCM 알림 전송
- [ ] 공유 일정 변경 알림
- [ ] 참석 확인 요청
- [ ] 알림 센터 UI

### 외부 연동
- [ ] 웹 공유 API
- [ ] 링크 프리뷰 (Open Graph)
- [ ] 공유 링크 접근

---

## 🎯 최종 목표 (이번주 일요일까지)

**일요일까지 달성해야 할 상태:**
- ✅ 친구 시스템 기본 작동 (검색, 추가, 목록)
- ✅ 일정 공유 기능 작동 (공유 설정, 보기)
- ✅ 공유 링크 생성 및 접근
- ✅ 공유 일정 실시간 동기화 (기본)
- ✅ 기본 알림 시스템 (공유 변경 알림, 일정 시작 전 알림)
- ✅ 웹 공유 API (네이티브 공유)

**완성도**: MVP 수준이지만 핵심 네트워크 기능은 데모 가능한 상태

**우선순위 조정:**
- 🔴 최우선: 친구 시스템, 일정 공유, 공유 링크
- 🟡 중요: 실시간 동기화, 기본 알림
- 🟢 선택: 참석 확인, 고급 알림 설정, 외부 SNS 연동 (시간 남으면)

